<html>
<head>
    <meta charset="utf-8" />
    <title>Gallery Baikal</title>

    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://libs.zappar.com/zappar-aframe/0.3.29/zappar-aframe.js"></script>

    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-detector.js"></script>
    <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-handler.js"></script>
</head>

<body>
<a-scene framet
        cursor="rayOrigin: mouse"
        raycaster="objects: [data-clickable]"
>
    <a-assets>
        <video
                id="video1"
                src="https://cdn.glitch.me/72d9ba18-b157-4642-8724-0dbe77d6c9d0/%D0%B2%D0%B8%D0%B4%D1%8F%D0%BE.mp4?v=1646990174793"
                preload="auto"
                response-type="arraybuffer"
                loop
                crossorigin
                webkit-playsinline
                autoplay
                muted
                playsinline
        ></video>

        <img
                id="next"
                src="https://cdn.glitch.global/314ea0a4-1a42-4ab9-b4f2-257347a933b7/1904671-arrow-arrow-right-change-direction-next-page-right_122521.png?v=1646722525318"
        />
        <img
                id="prev"
                src="https://cdn.glitch.global/72d9ba18-b157-4642-8724-0dbe77d6c9d0/%D1%81%D1%82%D1%80%D0%B5%D0%BB%D0%BE%D1%87%D0%BA%D0%B0%D0%BB%D0%B5%D0%B2%D0%BE.png?v=1646989621172"
        />

        <!-- Картинки оверлеи: фотографии из галереи -->
        <img
                id="picture1"
                src="https://cdn.glitch.global/72d9ba18-b157-4642-8724-0dbe77d6c9d0/%D0%B1%D0%B0%D0%B9%D0%BA%D0%B0%D0%BB.jpg?v=1646988142575"
        />
        <img
                id="picture2"
                src="https://cdn.glitch.global/72d9ba18-b157-4642-8724-0dbe77d6c9d0/%D0%B1%D0%B0%D0%B9%D0%BA%D0%B0%D0%BB1.jpg?v=1646988168479"
        />
        <img
                id="picture3"
                src="https://cdn.glitch.global/72d9ba18-b157-4642-8724-0dbe77d6c9d0/%D0%B1%D0%B0%D0%B9%D0%BA%D0%B0%D0%BB2.jpg?v=1646988180261"
        />
        <img
                id="picture4"
                src="https://cdn.glitch.global/72d9ba18-b157-4642-8724-0dbe77d6c9d0/%D0%B1%D0%B0%D0%B9%D0%BA%D0%B0%D0%BB3.jpg?v=1646988196275"
        />
        <img
                id="picture5"
                src="https://cdn.glitch.global/72d9ba18-b157-4642-8724-0dbe77d6c9d0/%D0%B1%D0%B0%D0%B9%D0%BA%D0%B0%D0%BB4.jpg?v=1646988214041"
        />
        <img
                id="picture6"
                src="https://cdn.glitch.global/72d9ba18-b157-4642-8724-0dbe77d6c9d0/%D0%B1%D0%B0%D0%B9%D0%BA%D0%B0%D0%BB5.jpg?v=1646988235293"
        />



        <a-asset-item
                id="target"
                src="https://cdn.glitch.global/d41d488d-3288-4e87-8df1-22b117cb9dca/mytrack.zpt?v=1646939050650"
        />


    </a-assets>




    <a-entity zappar-permissions-ui id="permissions">
        <a-entity text="value: Please reload the page, accepting the camera permissions." position="0 0 -2">
        </a-entity>
    </a-entity>
    <a-entity camera zappar-camera></a-entity>

    <a-entity zappar-image="target: #target ">
        <a-entity>
            <a-plane
                    id="pic0"
                    visible="false"
                    src="#picture1"
                    width="1.51"
                    height="1.5"
                    position="0 0 -0.01"
            >
            </a-plane>

            <a-plane
                    id="pic1"
                    visible="false"
                    src="#picture2"
                    width="1.51"
                    height="1.5"
                    position="0 0 -0.01"
            >
            </a-plane>
            <a-plane
                    id="pic2"
                    visible="false"
                    src="#picture3"
                    width="1.51"
                    height="1.5"
                    position="0 0 -0.01"
            >
            </a-plane>
            <a-plane
                    id="pic3"
                    visible="false"
                    src="#picture4"
                    width="1.51"
                    height="1.5"
                    position="0 0 -0.01"
            >
            </a-plane>
            <a-plane
                    id="pic4"
                    visible="false"
                    src="#picture5"
                    width="1.51"
                    height="1.5"
                    position="0 0 -0.01"
            >
            </a-plane>
            <a-plane
                    id="pic5"
                    visible="false"
                    src="#picture6"
                    width="1.51"
                    height="1.5"
                    position="0 0 -0.01"
            >
            </a-plane>

            <a-video
                    id="pic6"
                    src="#video1"
                    visible="false"
                    scale="1 2 1"
                    position="0 0 -0.1"

                    class="clickable"
                    gesture-handler
            ></a-video>

        </a-entity>

        <a-entity
                geometry="primitive: plane"
                material="src: #next; transparent: true;"
                position="0.7 0 0"
                scale="0.2 0.2 0.2"
                data-clickable
                onclick="OnNextClick()"
        ></a-entity>

        <a-entity
                geometry="primitive: plane"
                material="src: #prev; transparent: true;"
                position="-0.7 0 0"
                scale="0.2 0.2 0.2"
                data-clickable
                onclick="OnPrevClick()"
        ></a-entity>
    </a-entity>
</a-scene>

<script>
    var curr = 0;
    var picAmount = 7;
    var d = document;

    AFRAME.registerComponent("framet", {
        init: function () {

        },
    });

    function OnNextClick() {
        if (curr < picAmount - 1) {
            curr++;
            d.getElementById("pic" + curr).setAttribute("visible", true);
            d.getElementById("pic" + (curr - 1)).setAttribute("visible", false);
            if(curr == 6){
                d.getElementById("pic" + curr).setAttribute("visible", true);
                d.getElementById("pic" + (curr - 1)).setAttribute("visible", false);
                this.vid = document.querySelector("#video1");
                this.vid.play();
            }
        }
    }


    function OnPrevClick() {
        if (curr > 0) {
            curr--;
            d.getElementById("pic" + curr).setAttribute("visible", true);
            d.getElementById("pic" + (curr + 1)).setAttribute("visible", false);
        }
    }
</script>
</body>
</html>